<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trend Analysis - Academic Integrity Monitor</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css"
      rel="stylesheet"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
      :root {
        --primary: #1a73e8;
        --primary-dark: #0d47a1;
        --secondary: #2a9d8f;
        --danger: #e63946;
        --success: #43a047;
        --warning: #ffa000;
        --gray-light: #f5f7fa;
        --gray: #e0e0e0;
        --gray-dark: #757575;
        --dark: #263238;
      }

      @media print {
    body {
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }
    
    .card-shadow {
      box-shadow: none !important;
    }
    
    .assignment-card {
      page-break-inside: avoid;
    }
  }
  
  /* Additional style for the download button */
  #download-pdf {
    background-color: white;
    color: #1a73e8;
    border: 1px solid #1a73e8;
    transition: all 0.3s ease;
  }
  
  #download-pdf:hover {
    background-color: #f0f7ff;
  }

      .bg-gradient {
        background: linear-gradient(135deg, #4b6cb7 0%, #182848 100%);
      }
      .card-shadow {
        box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
      }
      .assignment-card {
        transition: all 0.3s ease;
      }
      .assignment-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1),
          0 10px 10px -5px rgba(0, 0, 0, 0.04);
      }
      .collapsible-content {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.5s ease-out;
      }
      .expanded {
        max-height: 2000px;
        transition: max-height 0.5s ease-in;
      }
      .loading {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(255, 255, 255, 0.8);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }
      .spinner {
        border: 4px solid rgba(0, 0, 0, 0.1);
        width: 36px;
        height: 36px;
        border-radius: 50%;
        border-left-color: #4b6cb7;
        animation: spin 1s linear infinite;
      }
      @keyframes spin {
        0% {
          transform: rotate(0deg);
        }
        100% {
          transform: rotate(360deg);
        }
      }
      .tooltip {
        position: relative;
        display: inline-block;
      }
      .tooltip .tooltiptext {
        visibility: hidden;
        width: 200px;
        background-color: #555;
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 5px;
        position: absolute;
        z-index: 1;
        bottom: 125%;
        left: 50%;
        margin-left: -100px;
        opacity: 0;
        transition: opacity 0.3s;
      }
      .tooltip:hover .tooltiptext {
        visibility: visible;
        opacity: 1;
      }
      .tab-active {
        border-bottom: 3px solid #4b6cb7;
        color: #4b6cb7;
      }

      /* Navbar styles from fraud detector */
      .navbar {
        background-color: #1a73e8;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        position: sticky;
        top: 0;
        z-index: 100;
      }

      .navbar-container {
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 20px;
      }

      .navbar-brand {
        display: flex;
        align-items: center;
        padding: 15px 0;
      }

      .navbar-brand h1 {
        color: white;
        font-size: 1.5rem;
        margin-left: 10px;
      }

      .navbar-brand i {
        font-size: 1.8rem;
        color: white;
      }

      .navbar-menu {
        display: flex;
        gap: 20px;
      }

      .navbar-menu a {
        color: white;
        text-decoration: none;
        padding: 15px 15px;
        font-size: 1rem;
        font-weight: 500;
        transition: all 0.3s ease;
        border-radius: 4px;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .navbar-menu a:hover {
        background-color: rgba(255, 255, 255, 0.1);
      }

      .navbar-menu a.active {
        background-color: rgba(255, 255, 255, 0.2);
      }

      /* Responsive navbar */
      @media (max-width: 768px) {
        .navbar-container {
          flex-direction: column;
          padding: 10px;
        }

        .navbar-brand {
          margin-bottom: 10px;
          margin-right: 0;
        }

        .navbar-menu {
          flex-wrap: wrap;
          justify-content: center;
        }
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <div id="loading" class="loading" style="display: none">
      <div class="spinner"></div>
    </div>

    <!-- New Navbar Section from Fraud Detector -->
    <nav class="navbar">
      <div class="navbar-container">
        <div class="navbar-brand">
          <i class="fas fa-shield-alt"></i>
          <h1>Trend Analysis</h1>
        </div>
        <div class="navbar-menu">
          <a href="/" class="active"><i class="fas fa-home"></i> Home</a>
          <a href="#" id="download-pdf" class="bg-white text-blue-600 hover:bg-blue-100">
            <i class="fas fa-download"></i> Download Report
          </a>
        </div>
      </div>
    </nav>

    <!-- Dashboard Overview Section -->
    <section class="container mx-auto px-4 py-8">
      <div class="flex flex-wrap -mx-4">
        <!-- Overview Stats Cards -->
        <div class="w-full md:w-1/3 px-4 mb-6">
          <div class="bg-white rounded-lg card-shadow p-6 text-center">
            <div class="text-blue-500 text-4xl mb-2">
              <i class="fas fa-file-alt"></i>
            </div>
            <div
              class="text-5xl font-bold text-gray-800 mb-2"
              id="total-assignments"
            >
              0
            </div>
            <div class="text-gray-600">Total Assignments</div>
          </div>
        </div>
        <div class="w-full md:w-1/3 px-4 mb-6">
          <div class="bg-white rounded-lg card-shadow p-6 text-center">
            <div class="text-red-500 text-4xl mb-2">
              <i class="fas fa-robot"></i>
            </div>
            <div
              class="text-5xl font-bold text-gray-800 mb-2"
              id="high-ai-count"
            >
              0
            </div>
            <div class="text-gray-600">High AI Detection</div>
          </div>
        </div>
        <div class="w-full md:w-1/3 px-4 mb-6">
          <div class="bg-white rounded-lg card-shadow p-6 text-center">
            <div class="text-yellow-500 text-4xl mb-2">
              <i class="fas fa-copy"></i>
            </div>
            <div
              class="text-5xl font-bold text-gray-800 mb-2"
              id="high-plagiarism-count"
            >
              0
            </div>
            <div class="text-gray-600">High Plagiarism</div>
          </div>
        </div>
      </div>

      <!-- Threshold Controls -->
      <div class="bg-white rounded-lg card-shadow p-6 mb-8">
        <h2 class="text-xl font-bold text-gray-800 mb-4">
          Analysis Thresholds
        </h2>
        <div class="flex flex-wrap -mx-2">
          <div class="w-full md:w-1/2 px-2 mb-4">
            <label class="block text-gray-700 mb-2" for="ai-threshold">
              AI Content Detection Threshold (%)
              <div class="tooltip ml-1">
                <i class="fas fa-info-circle text-blue-500"></i>
                <span class="tooltiptext"
                  >Submissions with AI scores above this threshold are counted
                  as high AI detection</span
                >
              </div>
            </label>
            <div class="flex items-center">
              <input
                type="range"
                id="ai-threshold"
                min="0"
                max="100"
                value="50"
                class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
              />
              <span
                id="ai-threshold-value"
                class="ml-3 text-gray-700 min-w-[40px]"
                >50%</span
              >
            </div>
          </div>
          <div class="w-full md:w-1/2 px-2 mb-4">
            <label class="block text-gray-700 mb-2" for="plagiarism-threshold">
              Plagiarism Detection Threshold (%)
              <div class="tooltip ml-1">
                <i class="fas fa-info-circle text-blue-500"></i>
                <span class="tooltiptext"
                  >Submissions with plagiarism scores above this threshold are
                  counted as high plagiarism</span
                >
              </div>
            </label>
            <div class="flex items-center">
              <input
                type="range"
                id="plagiarism-threshold"
                min="0"
                max="100"
                value="30"
                class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"
              />
              <span
                id="plagiarism-threshold-value"
                class="ml-3 text-gray-700 min-w-[40px]"
                >30%</span
              >
            </div>
          </div>
        </div>
        <div class="mt-4">
          <button
            id="apply-thresholds"
            class="bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg transition-colors duration-300"
          >
            Apply Thresholds
          </button>
        </div>
      </div>

      <!-- Graph Tabs -->
      <div class="bg-white rounded-lg card-shadow mb-8">
        <div class="flex border-b">
          <button
            class="tab-button flex-1 py-4 px-6 font-medium text-center tab-active"
            data-tab="summary"
          >
            Overall Summary
          </button>
          <button
            class="tab-button flex-1 py-4 px-6 font-medium text-center"
            data-tab="trends"
          >
            Trend Analysis
          </button>
        </div>
        <div class="p-6">
          <!-- Summary Tab Content -->
          <div id="summary-tab" class="tab-content">
            <div class="flex flex-wrap -mx-4">
              <div class="w-full lg:w-1/2 px-4 mb-6">
                <h3 class="text-lg font-semibold mb-4">
                  AI Content Detection Summary
                </h3>
                <div class="h-64">
                  <canvas id="aiChart"></canvas>
                </div>
              </div>
              <div class="w-full lg:w-1/2 px-4 mb-6">
                <h3 class="text-lg font-semibold mb-4">
                  Plagiarism Detection Summary
                </h3>
                <div class="h-64">
                  <canvas id="plagiarismChart"></canvas>
                </div>
              </div>
            </div>
          </div>

          <!-- Trends Tab Content -->
          <div id="trends-tab" class="tab-content hidden">
            <h3 class="text-lg font-semibold mb-4">
              Assignment Integrity Trends
            </h3>
            <div class="h-80">
              <canvas id="trendsChart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Assignment List Section -->
      <h2 class="text-2xl font-bold text-gray-800 mb-4">Assignments</h2>
      <div
        id="assignments-container"
        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
      >
        <!-- Assignment cards will be added here dynamically -->
        <div class="col-span-full text-center text-gray-500 py-12">
          <i class="fas fa-spinner fa-spin text-3xl mb-4"></i>
          <p>Loading assignments...</p>
        </div>
      </div>
    </section>

    <script type="module" src="script.js"></script>
  </body>
</html>
